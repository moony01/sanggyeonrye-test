<!DOCTYPE html>
<html lang="{{ page.lang }}">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="description"
      content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}"
    />
    <meta name="theme-color" content="#283618" />
    <meta
      content="{{ site.url }}/kpopface/static/img/share/kakao-url-share.png"
      property="image"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
    />
    <link
      rel="alternate"
      type="application/rss+xml"
      title="기술비밀공유소: 소프트웨어 개발과 IT 혁신의 열쇠를 찾아서"
      href="https://moony01.com/sitemap.xml"
    />

    {% if page.lang != "ko" %}
    <link rel="icon" href="../favicon.png" type="image/x-icon" />

    <link rel="stylesheet" href="../static/css/common.css" />
    <link rel="stylesheet" href="../static/css/loading.css" />
    <link rel="stylesheet" href="../static/css/main.css" />
    <link rel="stylesheet" href="../static/css/modal.css" />
    <link rel="stylesheet" href="../static/css/comment.css" />

    <link rel="apple-touch-icon" href="../static/img/icon.png" />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="../static/img/icon.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="167x167"
      href="../static/img/icon.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="../static/img/icon.png"
    />

    <link rel="manifest" href="../manifestLang.json" />
    {% else %}
    <link rel="icon" href="favicon.png" type="image/x-icon" />

    <link rel="stylesheet" href="static/css/common.css" />
    <link rel="stylesheet" href="static/css/loading.css" />
    <link rel="stylesheet" href="static/css/main.css" />
    <link rel="stylesheet" href="static/css/modal.css" />
    <link rel="stylesheet" href="static/css/comment.css" />

    <link rel="apple-touch-icon" href="static/img/icon.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="static/img/icon.png" />
    <link rel="apple-touch-icon" sizes="167x167" href="static/img/icon.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="static/img/icon.png" />

    <link rel="manifest" href="manifest.json" />
    {% endif %}

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Jua&display=swap"
      rel="stylesheet"
    />
    <!-- Pretendard 폰트 (Canvas 렌더링용 - 한글 지원) -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css"
    />

    <!-- 카카오 공유하기 -->
    <script src="//developers.kakao.com/sdk/js/kakao.min.js"></script>
    <!-- 구글애드센스 -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8955182453510440"
      crossorigin="anonymous"
    ></script>
    <script
      class="jsbin"
      src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>

    <!-- T1.2: Canvas API 결과 이미지 생성기 (app.js보다 먼저 로드) -->
    <script src="{{ site.baseurl }}/static/js/imageGenerator.js"></script>
    <script src="{{ site.baseurl }}/static/js/app.js"></script>
    <script src="{{ site.baseurl }}/static/js/comment.js"></script>
    {% if page.title %}
    <meta content="{{ page.title }}" property="og:title" />
    <meta content="article" property="og:type" />
    {% else %}
    <meta content="{{ site.title }}" property="og:title" />
    <meta content="website" property="og:type" />
    {% endif %} {% if page.url %}
    <meta content="{{ site.url }}/kpopface{{ page.url }}" property="og:url" />
    {% endif %}

    <meta
      content="{{ site.url }}/kpopface/static/img/share/kakao-url-share.png"
      property="og:image"
    />

    <!-- OG 보완 -->
    <meta property="og:site_name" content="K-Pop Face Test">
    {% if page.lang == "ko" %}
    <meta property="og:locale" content="ko_KR">
    {% elsif page.lang == "en" %}
    <meta property="og:locale" content="en_US">
    {% elsif page.lang == "ja" %}
    <meta property="og:locale" content="ja_JP">
    {% elsif page.lang == "zh" %}
    <meta property="og:locale" content="zh_CN">
    {% elsif page.lang == "de" %}
    <meta property="og:locale" content="de_DE">
    {% elsif page.lang == "es" %}
    <meta property="og:locale" content="es_ES">
    {% elsif page.lang == "fr" %}
    <meta property="og:locale" content="fr_FR">
    {% elsif page.lang == "id" %}
    <meta property="og:locale" content="id_ID">
    {% elsif page.lang == "nl" %}
    <meta property="og:locale" content="nl_NL">
    {% elsif page.lang == "pl" %}
    <meta property="og:locale" content="pl_PL">
    {% elsif page.lang == "pt" %}
    <meta property="og:locale" content="pt_BR">
    {% elsif page.lang == "ru" %}
    <meta property="og:locale" content="ru_RU">
    {% elsif page.lang == "tr" %}
    <meta property="og:locale" content="tr_TR">
    {% elsif page.lang == "uk" %}
    <meta property="og:locale" content="uk_UA">
    {% elsif page.lang == "vi" %}
    <meta property="og:locale" content="vi_VN">
    {% else %}
    <meta property="og:locale" content="ko_KR">
    {% endif %}

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    {% if page.title %}
    <meta name="twitter:title" content="{{ page.title }}">
    {% else %}
    <meta name="twitter:title" content="{{ site.title }}">
    {% endif %}
    {% if page.description %}
    <meta name="twitter:description" content="{{ page.description }}">
    {% else %}
    <meta name="twitter:description" content="{{ site.description }}">
    {% endif %}
    <meta name="twitter:image" content="{{ site.url }}/kpopface/static/img/share/kakao-url-share.png">

    <!-- Canonical URL -->
    <link rel="canonical" href="{{ site.url }}/kpopface{{ page.url }}">

    <!-- hreflang 다국어 SEO -->
    <link rel="alternate" hreflang="ko" href="{{ site.url }}/kpopface/">
    <link rel="alternate" hreflang="en" href="{{ site.url }}/kpopface/en/">
    <link rel="alternate" hreflang="ja" href="{{ site.url }}/kpopface/ja/">
    <link rel="alternate" hreflang="zh" href="{{ site.url }}/kpopface/zh/">
    <link rel="alternate" hreflang="de" href="{{ site.url }}/kpopface/de/">
    <link rel="alternate" hreflang="es" href="{{ site.url }}/kpopface/es/">
    <link rel="alternate" hreflang="fr" href="{{ site.url }}/kpopface/fr/">
    <link rel="alternate" hreflang="id" href="{{ site.url }}/kpopface/id/">
    <link rel="alternate" hreflang="nl" href="{{ site.url }}/kpopface/nl/">
    <link rel="alternate" hreflang="pl" href="{{ site.url }}/kpopface/pl/">
    <link rel="alternate" hreflang="pt" href="{{ site.url }}/kpopface/pt/">
    <link rel="alternate" hreflang="ru" href="{{ site.url }}/kpopface/ru/">
    <link rel="alternate" hreflang="tr" href="{{ site.url }}/kpopface/tr/">
    <link rel="alternate" hreflang="uk" href="{{ site.url }}/kpopface/uk/">
    <link rel="alternate" hreflang="vi" href="{{ site.url }}/kpopface/vi/">
    <link rel="alternate" hreflang="x-default" href="{{ site.url }}/kpopface/en/">

    <!-- JSON-LD 구조화 데이터 -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "K-Pop Face Test",
      "alternateName": "{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}",
      "description": "{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}",
      "url": "{{ site.url }}/kpopface{{ page.url }}",
      "applicationCategory": "Entertainment",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "KRW"
      },
      "inLanguage": ["ko", "en", "ja", "zh", "de", "es", "fr", "id", "nl", "pl", "pt", "ru", "tr", "uk", "vi"]
    }
    </script>

    {% if page.description %}
    <meta content="{{ page.description }}" property="og:description" />
    {% else %}
    <meta content="{{ site.description }}" property="og:description" />
    {% endif %} {% if jekyll.environment == "production" %}
    <!-- Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id='{{ site.google_analytics }}'"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "{{ site.google_analytics }}");
    </script>
    {% endif %}

    <script>
      const userAgent = navigator.userAgent;
      const isReactNativeWebView = /wv|WebView/i.test(userAgent);
      langType = location.pathname.split("/")[2];

      //모든 페이지에 영향을 미치는 공통 요소들의 언어를 변경하는 함수
      document.addEventListener("DOMContentLoaded", function () {
        /*
         * 1. REACT NATIVE WEBVIEW 에서는 모달 팝업을 띄우지 않음
         * 2. 메인페이지를 제외한 나머지 페이지에서는 모달 팝업을 띄우지 않음
         */
        console.log("webview connect: ", isReactNativeWebView);
        //URL이 "/", "/index.html" 일 경우 모달팝업 띄우기
        // if (window.location.pathname === "/kpopface/" || window.location.pathname === "/kpopface/index.html") {
        //     document.getElementById("appDown").style.display = "none";
        //     //REACT NATIVE WEBVIEW가 아닐 경우 모달팝업 띄우기
        //     if (!isReactNativeWebView) {
        //         document.getElementById("appDown").style.display = "none";
        //     }
        // }

        // 서비스 워커 등록
        if ("serviceWorker" in navigator) {
          if (!langType == "" || !langType == null || !langType == "ko") {
            navigator.serviceWorker
              .register("../pwabuilder-sw.js")
              .then(function (registration) {
                console.log(
                  "Service Worker registered with scope:",
                  registration.scope
                );
              })
              .catch(function (err) {
                console.log("Service Worker registration failed", err);
              });
          } else {
            navigator.serviceWorker
              .register("pwabuilder-sw.js")
              .then(function (registration) {
                console.log(
                  "Service Worker registered with scope:",
                  registration.scope
                );
              })
              .catch(function (err) {
                console.log("Service Worker registration failed", err);
              });
          }
        }
      });
    </script>
    <!-- <script type="module">
        import 'https://cdn.jsdelivr.net/npm/@pwabuilder/pwaupdate';
        const el = document.createElement('pwa-update');
        document.body.appendChild(el);
    </script> -->
    <title>
      {% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}
    </title>
  </head>
  <body>
    {% include cross-site-nav.html %}
    <div class="site-pusher">
      {{ content }}
      <div class="modal-body app-download-wrap">
        {% if page.lang != "ko" %}
        <p class="adw-head">Would you like to download the app?</p>
        <div class="modal-btn">
          <!-- <button class="modal-down"><i class="fab fa-apple"></i><span>App Store</span></button> -->
          <button class="modal-down" onclick="fnAppDownloadPage('android')">
            <i class="fab fa-google-play"></i><span>Google Play</span>
          </button>
          <button
            class="modal-down app-download"
            onclick="fnAppDownloadPage('a2hs')"
          >
            <i class="fa-solid fa-mobile-button"></i><span>Add To App</span>
          </button>
        </div>
        {% else %}
        <p class="adw-head">앱을 다운로드하시겠습니까?</p>
        <div class="modal-btn">
          <!-- <button class="modal-down"><i class="fab fa-apple"></i><span>App Store</span></button> -->
          <button class="modal-down" onclick="fnAppDownloadPage('android')">
            <i class="fab fa-google-play"></i><span>구글플레이</span>
          </button>
          <button
            class="modal-down app-download"
            onclick="fnAppDownloadPage('a2hs')"
          >
            <i class="fa-solid fa-mobile-button"></i><span>앱 직접설치</span>
          </button>
        </div>
        {% endif %}
      </div>
      <!--     {% include disqus.html %} -->
      <footer class="footer">
        <span>© kpopface 2023. ALL Rights Reserved.</span>
        <a class="privacy" href="{{ site.url }}/kpopface/privacy.html"
          >Privacy policy</a
        >
      </footer>
      <div class="site-cache" id="site-cache"></div>
    </div>
  </body>
</html>
